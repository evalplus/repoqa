{"author":{"id":"MDQ6VXNlcjExNjc1NzU=","is_bot":false,"login":"josephrocca","name":""},"body":"My tokenizer files are hosted within this folder:\r\n```\r\nhttps://example.com/public/models/TheBloke/Llama-2-13B-GPTQ/\r\n```\r\nFirst I load the lib:\r\n```js\r\nlet { AutoTokenizer } = await import('https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.1');\r\n```\r\nThen I tried what I thought would be the most obvious/intuitive API:\r\n```js\r\nawait AutoTokenizer.from_pretrained(\"/public/models/TheBloke/Llama-2-13B-GPTQ\")\r\n// requests: https://example.com/models/public/models/TheBloke/Llama-2-13B-GPTQ/tokenizer.json\r\n```\r\nThis is strongly counter-intuitive to me. If I add a `/` at the start of the URL, it shouldn't add anything before that. A path that starts with `/` on the web always means \"append this to the origin\".\r\n\r\nSo I read the docs, and it seems to suggest that you need to put at `.` on the end:\r\n```js\r\nawait AutoTokenizer.from_pretrained(\"/public/models/TheBloke/Llama-2-13B-GPTQ/.\")\r\n// requests: https://example.com/models/public/models/TheBloke/Llama-2-13B-GPTQ/tokenizer.json \r\n```\r\nNope. So the next obvious step was to just give it an absolute URL and be done with it:\r\n```js\r\nawait AutoTokenizer.from_pretrained(\"https://example.com/public/models/TheBloke/Llama-2-13B-GPTQ\")\r\n// requests:  'https://huggingface.co/https://example.com/public/models/TheBloke/Llama-2-13B-GPTQ/resolve/main/tokenizer_config.json\r\n```\r\nOof.\r\n\r\nSo I'm a bit confused here ðŸ˜µâ€ðŸ’«\r\n\r\nGoing to keep trying, but I've spent 20 minutes on this so far, so posting here so you can improve the DX around this, even if I do manage to solve it myself soon.","comments":[{"id":"IC_kwDOI9T9VM5ntnIg","author":{"login":"xenova"},"authorAssociation":"OWNER","body":"If your app is hosted on a different site as the models, the terminology I use is `remoteModels`:\r\n\r\nYou can try set `env.remoteHost` and/or `env.remotePathTemplate` (see [docs](https://huggingface.co/docs/transformers.js/api/env#:~:text=Hugging%20Face%20Hub.-,remoteHost,-string))\r\n\r\n![image](https://github.com/xenova/transformers.js/assets/26504141/ce72a93e-8471-4d5d-b3e4-f38e455543bd)\r\n\r\n\r\nThese values default to:\r\n```\r\nremoteHost: 'https://huggingface.co/',\r\nremotePathTemplate: '{model}/resolve/{revision}/',\r\n```\r\n(see [code](https://github.com/xenova/transformers.js/blob/5b31129218e2f6ea001f8477a094f4f3f15a2502/src/env.js#L101-L102)).\r\n\r\nOpen to suggestions on how to improve DX :) ","createdAt":"2023-09-28T21:10:11Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/xenova/transformers.js/issues/337#issuecomment-1740010016","viewerDidAuthor":false},{"id":"IC_kwDOI9T9VM5ntnWd","author":{"login":"xenova"},"authorAssociation":"OWNER","body":"If your app is hosted on the same site as the models (terminology: `localModels`), then you can modify `env.localModelPath`. It defaults to `/models/` as you see above.\r\n```js\r\nimport { env } from '@xenova/transformers';\r\nenv.localModelPath = '/path/to/local/models/';\r\n// subsequent requests will go to https://example.com/path/to/local/models/\r\n```","createdAt":"2023-09-28T21:11:04Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/xenova/transformers.js/issues/337#issuecomment-1740010909","viewerDidAuthor":false},{"id":"IC_kwDOI9T9VM5ntzpk","author":{"login":"josephrocca"},"authorAssociation":"CONTRIBUTOR","body":"Ah, thanks! :pray:  I think the main DX improvement here would just be to mention that here where it says:\r\n\r\n> A path to a *directory* containing tokenizer files, e.g., `./my_model_directory/.`:\r\n\r\n![image](https://github.com/xenova/transformers.js/assets/1167575/4f0f42ac-f2de-46dd-a632-061edb4f3d0b)\r\n\r\nHere's the line: https://github.com/xenova/transformers.js/blob/main/src/tokenizers.js#L3812C11-L3812C11\r\n\r\nI was going to make a quick pull request just now using the Github web editor but wasn't really sure on the wording here. Maybe something like \"`env.localModelPath` will be prepended to the path\" where `env.localModelPath` is also a link to https://huggingface.co/docs/transformers.js/custom_usage ?\r\n\r\nBut I'd also vote for URLs starting with `/` and `https://` to be treated differently. Same with `blob:` and `data:` too I guess, since I did consider embedding the tokenizer files in the page for quicker load. Also it definitely seems like the default `localModelPath` path should just be empty rather than \"models\". That would have been another route to reducing confusion/friction for me here.\r\n\r\nAll of that said, I haven't thought about this long so don't weight these thoughts too much!","createdAt":"2023-09-28T22:03:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}},{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/xenova/transformers.js/issues/337#issuecomment-1740061284","viewerDidAuthor":false}],"createdAt":"2023-09-28T21:00:41Z","labels":[{"id":"LA_kwDOI9T9VM8AAAABMvEY-w","name":"question","description":"Further information is requested","color":"d876e3"}],"title":"[Question] How do I specify a non-huggingface URL (that doesn't start with `/models/`) in `AutoTokenizer.from_pretrained`?","updatedAt":"2023-09-28T22:03:05Z"}
